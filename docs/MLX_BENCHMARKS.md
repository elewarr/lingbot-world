# MLX Backend Benchmarks

> Auto-generated by `scripts/benchmark_mlx.py`
> Generated: 2026-02-05T20:50:31.521660

## Configuration

- **Hardware**: Apple Silicon (Apple M3 Ultra), 512GB
- **Model**: WanModel (14B parameters)
- **Resolution**: 480x832

## Results Summary

| Backend | Frames | Steps | Quant | Time/Step | Total | Model Mem | Speedup |
|---------|--------|-------|-------|-----------|-------|-----------|---------|
| PYTORCH | 41 | 20 | None | 8.5s | 2.8min | 69.1GB | 1.00x (baseline) |
| MLX | 41 | 20 | None | 6.8s | 2.3min | 69.1GB | 1.24x |
| MLX | 41 | 20 | int8 | 7.2s | 2.4min | 19.5GB | 1.18x |
| MLX | 41 | 20 | nf4 | 7.2s | 2.4min | 10.8GB | 1.19x |

## Detailed Analysis

### Quantization Memory Savings

| Quantization | Avg Model Memory | Memory Reduction |
|--------------|------------------|------------------|
| None (FP32) | 69.1GB | - |
| int8 | 19.5GB | 72% |
| nf4 | 10.8GB | 84% |

### Performance by Frame Count

**41 Frames:**

- PYTORCH (None): 8.5s/step, 2.8min total, 1.00x speedup
- MLX (None): 6.8s/step, 2.3min total, 1.24x speedup
- MLX (int8): 7.2s/step, 2.4min total, 1.18x speedup
- MLX (nf4): 7.2s/step, 2.4min total, 1.19x speedup

## Methodology

### Benchmark Procedure

1. **Warmup**: 1-2 forward passes to trigger JIT compilation
2. **Timing**: Each denoising step is timed individually
3. **Synchronization**: GPU operations are synchronized before timing
4. **Memory**: Peak process memory is recorded

### Notes

- All timings exclude model loading and VAE encode/decode
- Memory figures are for a single DiT model (full pipeline uses 2x)
- Synthetic benchmarks use smaller models; full benchmarks use production weights
- MPS backend uses float32 (bfloat16 not supported)

## Running Benchmarks

```bash
# Quick synthetic benchmark (no model required)
python scripts/benchmark_mlx.py --mode synthetic

# Full benchmark with model weights
python scripts/benchmark_mlx.py --ckpt_dir models/lingbot-world-base-cam

# Specific configuration
python scripts/benchmark_mlx.py --frames 41 --steps 20 --quant nf4
```
